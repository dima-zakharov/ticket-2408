id: ssrf-private-ip-protection

info:
  name: SSRF Private IP Range Protection Test
  author: security-team
  severity: info
  description: Test suite for private IP range SSRF protection (TC-SSRF-004)
  tags: ssrf,security,private-ip

variables:
  token: "{{TOKEN}}"

requests:
  # TC-SSRF-004: Private IP Ranges Blocked
  
  # 10.0.0.0/8 range
  - name: private-ip-10-range
    method: POST
    path:
      - "{{BaseURL}}/api/resources/fetch"
    headers:
      Authorization: "Bearer {{token}}"
      Content-Type: "application/json"
    body: '{"url":"http://10.0.0.1/admin"}'
    matchers:
      - type: status
        status:
          - 400
          - 403
        part: header

  - name: private-ip-10-edge
    method: POST
    path:
      - "{{BaseURL}}/api/resources/fetch"
    headers:
      Authorization: "Bearer {{token}}"
      Content-Type: "application/json"
    body: '{"url":"http://10.255.255.254/"}'
    matchers:
      - type: status
        status:
          - 400
          - 403
        part: header

  # 172.16.0.0/12 range
  - name: private-ip-172-16-range
    method: POST
    path:
      - "{{BaseURL}}/api/resources/fetch"
    headers:
      Authorization: "Bearer {{token}}"
      Content-Type: "application/json"
    body: '{"url":"http://172.16.0.1/internal"}'
    matchers:
      - type: status
        status:
          - 400
          - 403
        part: header

  - name: private-ip-172-31-edge
    method: POST
    path:
      - "{{BaseURL}}/api/resources/fetch"
    headers:
      Authorization: "Bearer {{token}}"
      Content-Type: "application/json"
    body: '{"url":"http://172.31.255.255/"}'
    matchers:
      - type: status
        status:
          - 400
          - 403
        part: header

  # 192.168.0.0/16 range
  - name: private-ip-192-168-range
    method: POST
    path:
      - "{{BaseURL}}/api/resources/fetch"
    headers:
      Authorization: "Bearer {{token}}"
      Content-Type: "application/json"
    body: '{"url":"http://192.168.1.1/"}'
    matchers:
      - type: status
        status:
          - 400
          - 403
        part: header

  - name: private-ip-192-168-edge
    method: POST
    path:
      - "{{BaseURL}}/api/resources/fetch"
    headers:
      Authorization: "Bearer {{token}}"
      Content-Type: "application/json"
    body: '{"url":"http://192.168.255.254/"}'
    matchers:
      - type: status
        status:
          - 400
          - 403
        part: header

  # CGNAT range (100.64.0.0/10)
  - name: private-ip-cgnat-range
    method: POST
    path:
      - "{{BaseURL}}/api/resources/fetch"
    headers:
      Authorization: "Bearer {{token}}"
      Content-Type: "application/json"
    body: '{"url":"http://100.64.0.1/"}'
    matchers:
      - type: status
        status:
          - 400
          - 403
        part: header
