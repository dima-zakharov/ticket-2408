meta {
  name: TC-SSRF-001 AWS Metadata Endpoint Blocked
  method: POST
  seq: 1
}

docs {
  """
  Test Case: TC-SSRF-001
  Objective: Verify AWS metadata service is blocked
  
  Expected: 400 or 403 response with SSRF protection message
  """
}

get {
  url: http://localhost:4444/resources/
  req {
    headers {
      Authorization: Bearer {{token}}
      Content-Type: application/json
    }
    body {
      json {
        resource {
          uri: http://169.254.169.254/latest/meta-data/
          name: aws-metadata-test
          content: test
        }
      }
    }
  }

  res {
    status: in [400, 403]
  }

  assert {
    res.status in [400, 403]
    res.body ~ /SSRF|blocked|not allowed|private|internal/i
  }
}
